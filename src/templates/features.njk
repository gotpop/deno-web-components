{% extends "base-hero.njk" %}
{% import "partials/feature-card.njk" as featureComponents %}

{% block hero %}
  <h1 variant="xxl" top="4" bottom="2" id="heading-primary">Features</h1>
  <p variant="lg" id="subheading" top="4">A collection of the latest in CSS and Web Components</p>
{% endblock %}

{% block page_content %}
  <grid-auto start="4" end="-4" top="4" bottom="4">
    <nav class="button-group" aria-label="Filter features">
      <a variant="button" href="?filter=browser-api">
        <span>Browser API</span></a>
      <a variant="button" href="?filter=css">
        <span>CSS</span></a>
      <a variant="button" href="?filter=cssom">
        <span>CSSOM</span></a>
      <a variant="button" href="/features">
        <span>All</span></a>
    </nav>
    <form method="GET" action="">
      <label for="order">Order:</label>
      <select class="custom-select" id="order" name="order" onchange="this.form.action = updateQueryString(this); this.form.submit();">
        <option value="">All</option>
        <option value="asc">Ascending</option>
        <option value="desc">Descending</option>
      </select>
    </form>
  </grid-auto>
  <grid-auto>
    {% for feature in features %}
      {{ featureComponents.featureCard(feature) }}
    {% endfor %}
  </grid-auto>
{% endblock %}

<script type="module">
  function updateQueryString(selectElement) {
    const url = new URL(window.location.href);
    const params = new URLSearchParams(url.search);

    // Update or add the selected value to the query string
    if (selectElement.value) {
      params.set(selectElement.name, selectElement.value);
    } else {
      params.delete(selectElement.name);
    }

    // Return the updated query string
    return `${url
      .pathname}?${params
      .toString()}`;
  }
</script>