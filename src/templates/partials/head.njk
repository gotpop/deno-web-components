<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>{{ title }} - Deno Web Components</title>
<link rel="stylesheet" href="/styles/main.css" />
<meta
  name="description"
  content="{{ description | default('A Deno Web Components project') }}"
/>
<link
  rel="icon"
  type="image/png"
  href="/images/favicon/favicon-96x96.png"
  sizes="96x96"
/>
<link rel="icon" type="image/svg+xml" href="/images/favicon/favicon.svg" />
<link rel="shortcut icon" href="/images/favicon/favicon.ico" />
<link
  rel="apple-touch-icon"
  sizes="180x180"
  href="/images/favicon/apple-touch-icon.png"
/>

<script defer type="module" src="./scripts/main.js"></script>
<script>
  (function () {
    // Create WebSocket connection for live reload
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    const host = window.location.host;
    const socket = new WebSocket(`${protocol}//${host}/live-reload`);

    // Connection opened
    socket.addEventListener("open", function (event) {
      console.log("Connected to live-reload server");
    });

    // Listen for messages
    socket.addEventListener("message", function (event) {
      if (event.data === "reload") {
        console.log("Reloading page due to file changes");
        window.location.reload();
      }
    });

    // Connection closed or error, attempt to reconnect
    socket.addEventListener("close", function () {
      console.log(
        "Live-reload connection closed, attempting to reconnect in 3s"
      );
      setTimeout(() => {
        window.location.reload();
      }, 3000);
    });

    // Handle connection errors
    socket.addEventListener("error", function (error) {
      console.error("Live-reload connection error:", error);
    });
  })();
</script>
{% if env.ENVIRONMENT == "development" %} {% endif %} {# {% if env ===
'development' %}
<script src="/scripts/live-reload.js"></script>
{% endif %} #}

<link rel="preload" href="/styles/main.css" as="style" />
<link rel="modulepreload" href="./scripts/main.js" />
<script type="speculationrules">
  {
    "prerender": [
      {
        "urls": ["/", "/about", "/contact"]
      }
    ]
  }
</script>
